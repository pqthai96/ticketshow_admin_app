"use client";

import { Logo } from "@/components/logo";
import { cn } from "@/lib/utils";
import Link from "next/link";
import { usePathname } from "next/navigation";
import React, { useEffect, useState } from "react";
import { useSidebarContext } from "@/components/Layouts/sidebar/sidebar-context";
import { ArrowLeftIcon } from "@/assets/icons";
import { MenuItem } from "@/components/Layouts/sidebar/menu-item";

export function Sidebar() {
  const pathname = usePathname();
  const { setIsOpen, isOpen, isMobile, toggleSidebar } = useSidebarContext();
  const [expandedItems, setExpandedItems] = useState<string[]>([]);

  const toggleExpanded = (title: string) => {
    setExpandedItems((prev) => (prev.includes(title) ? [] : [title]));
  };

  return (
    <>
      {/* Mobile Overlay */}
      {isMobile && isOpen && (
        <div
          className="fixed inset-0 z-40 bg-black/50 transition-opacity duration-300"
          onClick={() => setIsOpen(false)}
          aria-hidden="true"
        />
      )}

      <aside
        className={cn(
          "max-w-[290px] overflow-hidden border-r border-gray-200 bg-white transition-[width] duration-200 ease-linear dark:border-gray-800 dark:bg-gray-dark",
          isMobile ? "fixed bottom-0 top-0 z-50" : "sticky top-0 h-screen",
          isOpen ? "w-full" : "w-0"
        )}
        aria-label="Main navigation"
        aria-hidden={!isOpen}
        // inert={!isOpen}
        inert={!isOpen ? true : undefined}
      >
        <div className="flex h-full flex-col py-10 pl-[25px] pr-[7px]">
          <div className="relative pr-4.5">
            <Link
              href={"/"}
              onClick={() => isMobile && toggleSidebar()}
              className="px-0 py-2.5 min-[850px]:py-0"
            >
              <Logo />
            </Link>

            {isMobile && (
              <button
                onClick={toggleSidebar}
                className="absolute left-3/4 right-4.5 top-1/2 -translate-y-1/2 text-right"
              >
                <span className="sr-only">Close Menu</span>

                <ArrowLeftIcon className="ml-auto size-7" />
              </button>
            )}
          </div>

          {/* Navigation */}
          <div className="custom-scrollbar mt-6 flex-1 overflow-y-auto pr-3 min-[850px]:mt-10">
            <div className="mb-6">
              <h2 className="mb-5 text-sm font-medium text-dark-4 dark:text-dark-6">
                MAIN MENU
              </h2>

              <nav role="navigation">
                <ul className="space-y-2">
                  <li>
                    <MenuItem
                      className="flex items-center gap-3 py-3"
                      as="link"
                      href="/"
                      isActive={pathname === "/"}
                    >
                      <svg width="25" height="25" viewBox="0 0 25 25" fill="none"
                           xmlns="http://www.w3.org/2000/svg">
                        <path d="M14.5 19.5V12.5M10.5 12.5V5.5M5.5 12.5H19.5M5.5 19.5H19.5V5.5H5.5V19.5Z"
                              stroke="#121923" strokeWidth="1.2" />
                      </svg>
                      <span>Dashboard</span>
                    </MenuItem>
                  </li>
                  <li>
                    <MenuItem
                      className="flex items-center gap-3 py-3"
                      as="link"
                      href="/users"
                      isActive={pathname === "/users"}
                    >
                      <svg width="25" height="25" viewBox="0 0 24 24" fill="none"
                           xmlns="http://www.w3.org/2000/svg">
                        <circle cx="12" cy="6" r="4" stroke="#1C274C" strokeWidth="1.5" />
                        <path
                          d="M15 20.6151C14.0907 20.8619 13.0736 21 12 21C8.13401 21 5 19.2091 5 17C5 14.7909 8.13401 13 12 13C15.866 13 19 14.7909 19 17C19 17.3453 18.9234 17.6804 18.7795 18"
                          stroke="#1C274C" strokeWidth="1.5" strokeLinecap="round" />
                      </svg>
                      <span>User Management</span>
                    </MenuItem>
                  </li>
                  <li>
                    <MenuItem
                      className="flex items-center gap-3 py-3"
                      as="link"
                      href="/events"
                      isActive={pathname === "/events"}
                    >
                      <svg fill="#000000" width="22" height="22" viewBox="0 0 32 32" version="1.1"
                           xmlns="http://www.w3.org/2000/svg">
                        <path
                          d="M21.125 26.938c-0.5 0-0.875-0.406-0.875-0.906v-4.438c0-0.5 0.375-0.875 0.875-0.875h4.438c0.5 0 0.906 0.375 0.906 0.875v4.438c0 0.5-0.406 0.906-0.906 0.906h-4.438zM25.563 21.594h-4.438v4.438h4.438v-4.438zM30 3c1.094 0 2 0.906 2 2v25c0 1.094-0.906 2-2 2h-28c-1.094 0-2-0.906-2-2v-25c0-1.094 0.906-2 2-2h8v-2c0-0.563 0.438-1 1-1s1 0.438 1 1v2h8v-2c0-0.563 0.438-1 1-1s1 0.438 1 1v2h8zM2 30h28v-25h-8v1c0 0.563-0.438 1-1 1s-1-0.438-1-1v-1h-8v1c0 0.563-0.438 1-1 1s-1-0.438-1-1v-1h-8v25z"></path>
                      </svg>
                      <span>Event Management</span>
                    </MenuItem>
                  </li>
                  <li>
                    <MenuItem
                      className="flex items-center gap-3 py-3"
                      as="link"
                      href="/orders"
                      isActive={pathname === "/orders"}
                    >
                      <svg width="25" height="25" viewBox="0 0 1024 1024" fill="#000000" className="icon"
                           version="1.1" xmlns="http://www.w3.org/2000/svg">
                        <path d="M300 462.4h424.8v48H300v-48zM300 673.6H560v48H300v-48z" fill="" />
                        <path
                          d="M818.4 981.6H205.6c-12.8 0-24.8-2.4-36.8-7.2-11.2-4.8-21.6-11.2-29.6-20-8.8-8.8-15.2-18.4-20-29.6-4.8-12-7.2-24-7.2-36.8V250.4c0-12.8 2.4-24.8 7.2-36.8 4.8-11.2 11.2-21.6 20-29.6 8.8-8.8 18.4-15.2 29.6-20 12-4.8 24-7.2 36.8-7.2h92.8v47.2H205.6c-25.6 0-47.2 20.8-47.2 47.2v637.6c0 25.6 20.8 47.2 47.2 47.2h612c25.6 0 47.2-20.8 47.2-47.2V250.4c0-25.6-20.8-47.2-47.2-47.2H725.6v-47.2h92.8c12.8 0 24.8 2.4 36.8 7.2 11.2 4.8 21.6 11.2 29.6 20 8.8 8.8 15.2 18.4 20 29.6 4.8 12 7.2 24 7.2 36.8v637.6c0 12.8-2.4 24.8-7.2 36.8-4.8 11.2-11.2 21.6-20 29.6-8.8 8.8-18.4 15.2-29.6 20-12 5.6-24 8-36.8 8z"
                          fill="" />
                        <path
                          d="M747.2 297.6H276.8V144c0-32.8 26.4-59.2 59.2-59.2h60.8c21.6-43.2 66.4-71.2 116-71.2 49.6 0 94.4 28 116 71.2h60.8c32.8 0 59.2 26.4 59.2 59.2l-1.6 153.6z m-423.2-47.2h376.8V144c0-6.4-5.6-12-12-12H595.2l-5.6-16c-11.2-32.8-42.4-55.2-77.6-55.2-35.2 0-66.4 22.4-77.6 55.2l-5.6 16H335.2c-6.4 0-12 5.6-12 12v106.4z"
                          fill="" />
                      </svg>
                      <span>Order Management</span>
                    </MenuItem>
                  </li>
                  <li>
                    <MenuItem
                      className="flex items-center gap-3 py-3"
                      as="link"
                      href="/organisers"
                      isActive={pathname === "/organisers"}
                    >
                      <svg width="25" height="25" viewBox="0 0 24 24" fill="none"
                           xmlns="http://www.w3.org/2000/svg">
                        <path d="M11.7769 10L16.6065 11.2941" stroke="#1C274C" strokeWidth="1.5"
                              strokeLinecap="round" />
                        <path d="M11 12.8975L13.8978 13.6739" stroke="#1C274C" strokeWidth="1.5"
                              strokeLinecap="round" />
                        <path
                          d="M20.3116 12.6473C19.7074 14.9024 19.4052 16.0299 18.7203 16.7612C18.1795 17.3386 17.4796 17.7427 16.7092 17.9223C16.6129 17.9448 16.5152 17.9621 16.415 17.9744C15.4999 18.0873 14.3834 17.7881 12.3508 17.2435C10.0957 16.6392 8.96815 16.3371 8.23687 15.6522C7.65945 15.1114 7.25537 14.4115 7.07573 13.641C6.84821 12.6652 7.15033 11.5377 7.75458 9.28263L8.27222 7.35077C8.35912 7.02646 8.43977 6.72546 8.51621 6.44561C8.97128 4.77957 9.27709 3.86298 9.86351 3.23687C10.4043 2.65945 11.1042 2.25537 11.8747 2.07573C12.8504 1.84821 13.978 2.15033 16.2331 2.75458C18.4881 3.35883 19.6157 3.66095 20.347 4.34587C20.9244 4.88668 21.3285 5.58657 21.5081 6.35703C21.669 7.04708 21.565 7.81304 21.2766 9"
                          stroke="#1C274C" strokeWidth="1.5" strokeLinecap="round" />
                        <path
                          d="M3.27222 16.647C3.87647 18.9021 4.17859 20.0296 4.86351 20.7609C5.40432 21.3383 6.10421 21.7424 6.87466 21.922C7.85044 22.1495 8.97798 21.8474 11.2331 21.2432C13.4881 20.6389 14.6157 20.3368 15.347 19.6519C15.8399 19.1902 16.2065 18.6126 16.415 17.9741M8.51621 6.44531C8.16368 6.53646 7.77741 6.63996 7.35077 6.75428C5.09569 7.35853 3.96815 7.66065 3.23687 8.34557C2.65945 8.88638 2.25537 9.58627 2.07573 10.3567C1.91482 11.0468 2.01883 11.8129 2.30728 13"
                          stroke="#1C274C" strokeWidth="1.5" strokeLinecap="round" strokeLinejoin="round" />
                      </svg>
                      <span>Organiser Management</span>
                    </MenuItem>
                  </li>
                  <li>
                    <MenuItem
                      className="flex items-center gap-3 py-3"
                      as="link"
                      href="/vouchers"
                      isActive={pathname === "/vouchers"}
                    >
                      <svg fill="#000000" height="25" width="25" version="1.1" id="Layer_1"
                           xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                        <g>
                          <g>
                            <path d="M495.432,111.165H384.267c-4.427,0-8.017,3.589-8.017,8.017v8.551c0,5.01-4.076,9.086-9.086,9.086
                              c-5.01,0-9.086-4.076-9.086-9.086v-8.551c0-4.427-3.589-8.017-8.017-8.017H16.568C7.432,111.165,0,118.597,0,127.733v256.534
                              c0,9.136,7.432,16.568,16.568,16.568h333.495c4.427,0,8.017-3.589,8.017-8.017v-8.551c0-5.01,4.076-9.086,9.086-9.086
                              c5.01,0,9.086,4.076,9.086,9.086v8.551c0,4.427,3.589,8.017,8.017,8.017h111.165c9.136,0,16.568-7.432,16.568-16.568V127.733
                              C512,118.597,504.568,111.165,495.432,111.165z M495.967,247.983H264.551c-4.427,0-8.017,3.589-8.017,8.017
                              c0,4.427,3.589,8.017,8.017,8.017h231.415v120.25c0,0.295-0.239,0.534-0.534,0.534H392.284v-0.534
                              c0-11.048-7.172-20.446-17.102-23.8v-18.956c0-4.427-3.589-8.017-8.017-8.017c-4.427,0-8.017,3.589-8.017,8.017v18.956
                              c-9.93,3.354-17.102,12.752-17.102,23.8v0.534H195.608V332.96c0-4.427-3.589-8.017-8.017-8.017s-8.017,3.589-8.017,8.017v51.841
                              H16.568c-0.295,0-0.534-0.239-0.534-0.534v-120.25h94.597c4.427,0,8.017-3.589,8.017-8.017c0-4.427-3.589-8.017-8.017-8.017
                              H16.033v-120.25c0-0.295,0.239-0.534,0.534-0.534h163.006v51.841c0,4.427,3.589,8.017,8.017,8.017s8.017-3.589,8.017-8.017
                              v-51.841h146.438v0.534c0,11.048,7.172,20.446,17.102,23.8v18.956c0,4.427,3.589,8.017,8.017,8.017
                              c4.427,0,8.017-3.589,8.017-8.017v-18.956c9.93-3.354,17.102-12.752,17.102-23.8v-0.534h103.148c0.295,0,0.534,0.239,0.534,0.534
                              V247.983z" />
                          </g>
                        </g>
                        <g>
                          <g>
                            <path d="M367.165,196.676c-4.427,0-8.017,3.589-8.017,8.017v17.102c0,4.427,3.589,8.017,8.017,8.017
                              c4.427,0,8.017-3.589,8.017-8.017v-17.102C375.182,200.266,371.592,196.676,367.165,196.676z" />
                          </g>
                        </g>
                        <g>
                          <g>
                            <path d="M367.165,282.188c-4.427,0-8.017,3.589-8.017,8.017v17.102c0,4.427,3.589,8.017,8.017,8.017
                              c4.427,0,8.017-3.589,8.017-8.017v-17.102C375.182,285.777,371.592,282.188,367.165,282.188z" />
                          </g>
                        </g>
                        <g>
                          <g>
                            <path d="M269.664,282.76c-11.555-11.555-34.253-20.759-52.59-26.76c18.337-6.001,41.034-15.205,52.589-26.761
                              c7.387-7.387,11.455-17.209,11.455-27.657c0-10.446-4.068-20.268-11.455-27.657s-17.208-11.454-27.655-11.454
                              c-10.447,0-20.269,4.068-27.657,11.455c-11.555,11.555-20.759,34.253-26.761,52.589c-6.002-18.337-15.205-41.034-26.761-52.589
                              c-7.387-7.387-17.209-11.455-27.657-11.455c-10.446,0-20.268,4.068-27.656,11.455c-7.388,7.387-11.453,17.209-11.453,27.657
                              c0,10.447,4.068,20.269,11.455,27.657c11.555,11.555,34.253,20.759,52.589,26.761c-18.337,6.001-41.034,15.205-52.589,26.761
                              c-7.387,7.385-11.455,17.207-11.455,27.654c0,10.446,4.068,20.268,11.455,27.657c7.387,7.388,17.209,11.455,27.657,11.455
                              c10.447,0,20.269-4.068,27.657-11.455c11.555-11.555,20.759-34.253,26.761-52.589c6.002,18.337,15.205,41.034,26.761,52.589
                              c7.387,7.387,17.209,11.455,27.656,11.455c10.446,0,20.268-4.068,27.657-11.455c7.388-7.387,11.453-17.209,11.453-27.657
                              S277.051,290.147,269.664,282.76z M116.855,217.904c-4.358-4.36-6.759-10.156-6.759-16.32s2.401-11.96,6.76-16.319
                              s10.154-6.76,16.319-6.76s11.96,2.401,16.319,6.76c11.471,11.471,21.483,40.353,26.924,59.566
                              C157.212,239.395,128.342,229.39,116.855,217.904z M149.493,326.735c-4.359,4.359-10.154,6.76-16.319,6.76
                              s-11.96-2.401-16.319-6.76s-6.76-10.154-6.76-16.319s2.401-11.96,6.76-16.319c11.471-11.471,40.353-21.483,59.566-26.924
                              C170.984,286.378,160.98,315.249,149.493,326.735z M225.688,185.265c4.359-4.359,10.155-6.76,16.319-6.76s11.96,2.401,16.319,6.76
                              s6.76,10.154,6.76,16.319s-2.401,11.96-6.76,16.319c-11.471,11.471-40.353,21.483-59.566,26.924
                              C204.197,225.622,214.202,196.751,225.688,185.265z M258.326,326.735c-4.359,4.359-10.154,6.76-16.319,6.76
                              s-11.96-2.401-16.319-6.76c-11.471-11.471-21.483-40.353-26.924-59.566c19.206,5.436,48.076,15.441,59.563,26.928
                              c4.359,4.359,6.76,10.154,6.76,16.319S262.685,322.376,258.326,326.735z" />
                          </g>
                        </g>
                      </svg>
                      <span>Voucher Management</span>
                    </MenuItem>
                  </li>
                  <li>
                    <MenuItem
                      className="flex items-center gap-3 py-3"
                      as="link"
                      href="/support"
                      isActive={pathname === "/support"}
                    >
                      <svg fill="#000000" height="25" width="25" version="1.1" id="Layer_1"
                           xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 448">
                        <g>
                          <g>
                            <g>
                              <path d="M384,172.4C384,83.6,312.4,12,224,12S64,83.6,64,172c0,0,0,0,0,0.4C28.4,174.4,0,204,0,240v8c0,37.6,30.4,68,68,68h3.6
                                l28.4,45.2c20,32,54,50.8,91.6,50.8h5.6c3.6,13.6,16,24,30.8,24c17.6,0,32-14.4,32-32c0-17.6-14.4-32-32-32
                                c-14.8,0-27.2,10.4-30.8,24h-5.6c-32,0-61.2-16.4-78-43.6L90.4,316H96c8.8,0,16-7.2,16-16V188c0-8.8-7.2-16-16-16H80
                                c0-79.6,64.4-144,144-144s144,64.4,144,144h-16c-8.8,0-16,7.2-16,16v112c0,8.8,7.2,16,16,16h28c37.6,0,68-30.4,68-68v-8
                                C448,204,419.6,174.4,384,172.4z M228,388c8.8,0,16,7.2,16,16s-7.2,16-16,16s-16-7.2-16-16S219.2,388,228,388z M96,188v112H68
                                c-28.8,0-52-23.2-52-52v-8c0-28.8,23.2-52,52-52H96z M432,248c0,28.8-23.2,52-52,52h-28V188h28c28.8,0,52,23.2,52,52V248z" />
                              <path d="M290.4,72.4c-0.8-0.4-2-1.2-3.2-2c-1.2-0.8-2.4-1.6-3.2-2c-3.6-2.4-8.8-1.2-10.8,2.8S272,79.6,276,82
                                c0.8,0.4,2,1.2,3.2,2s2.4,1.6,3.6,2c1.2,0.8,2.8,1.2,4,1.2c2.8,0,5.2-1.2,6.8-4C295.6,79.6,294.4,74.8,290.4,72.4z" />
                              <path d="M224,52c-34,0-66,14.8-88,40.4c-2.8,3.2-2.4,8.4,0.8,11.2c1.6,1.2,3.2,2,5.2,2c2.4,0,4.4-0.8,6-2.8
                                c19.2-22,46.8-34.8,76-34.8c7.2,0,14.4,0.8,21.6,2.4c4.4,0.8,8.4-2,9.6-6s-2-8.4-6-9.6C240.8,52.8,232.4,52,224,52z" />
                            </g>
                          </g>
                        </g>
                        </svg>
                      <span>Support Request</span>
                    </MenuItem>
                  </li>
                </ul>
              </nav>
            </div>
          </div>
        </div>
      </aside>
    </>
  );
}
